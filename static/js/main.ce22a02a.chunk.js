(this["webpackJsonprest-api-react-client-example"]=this["webpackJsonprest-api-react-client-example"]||[]).push([[0],{23:function(e,t,n){},46:function(e,t,n){},47:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(3),a=n(1),i=n.n(a),c=n(15),s=n.n(c),l=(n(23),n(4)),u=n(7),d=n.n(u),h=n(16),b=n.n(h),p=n(2);function j(){return(j=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}"undefined"!==typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!==typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));var f=Object.freeze(["application/json","application/vnd.github.v3+json"]),m=function(){function e(e,t){this.baseUrl=e,this.headers=t.headers,this.options={mode:"cors",cache:"no-cache",redirect:"follow",referrerPolicy:"no-referrer"},this.response=this.response.bind(this)}var t=e.prototype;return t.getHeaders=function(e){void 0===e&&(e=!1);var t=this.headers();return e?j({Accept:"application/json","Content-Type":"application/json"},t):t},t.request=function(e){var t=e.path,n=e.query,r=e.body,o=e.json,a=e.baseUrl,i=e.method;try{var c=this,s=b.a.stringifyUrl({url:""+(a||c.baseUrl)+t,query:n});return Promise.resolve(function(e,t){try{var n=e()}catch(r){return t(r)}return n&&n.then?n.then(void 0,t):n}((function(){return Promise.resolve(fetch(s,j({},c.options,{method:i,headers:c.getHeaders(o),body:JSON.stringify(r)}))).then((function(e){return c.response(e)}))}),(function(e){return{data:e.message,status:500,statusText:"Internal server error"}})))}catch(l){return Promise.reject(l)}},t.response=function(e){try{var t=function(){return{status:e.status,statusText:e.statusText,data:r}},n=Object(p.getOr)("","Accept",this.getHeaders()),r=null,o=f.includes(n)?Promise.resolve(e.json()).then((function(e){r=e})):Promise.resolve(e.text()).then((function(e){r=e}));return Promise.resolve(o&&o.then?o.then(t):t())}catch(a){return Promise.reject(a)}},e}(),O=i.a.createContext({}),g=function(e){var t=e.children,n=e.client,r=Object(a.useState)({}),o=r[0],c=r[1];return i.a.createElement(O.Provider,{value:{value:o,setValue:c,client:n}},t)};g.propTypes={children:d.a.any.isRequired,client:d.a.instanceOf(m).isRequired};var v=function(){var e=Object(a.useContext)(O),t=e.value,n=e.setValue,r=e.client,o=function(e){n(j({},t,e))},i=function(e,t){var n=t.params,r=t.method;return JSON.stringify({path:e,params:n,method:r})};Object(a.useEffect)((function(){if(!r)throw new Error("Client not set, make sure the hooks are called insider the provider")}),[r]);return{data:t,cacheKey:i,setData:o,resetData:function(){return n({})},writeData:function(e,t){var n,r=t.params,a=t.data,c=t.method,s=i(e,{params:r,method:c});o(((n={})[s]=a,n))},fetchClient:r}},y=Object(p.getOr)({},"params"),S=Object(p.getOr)({},"query"),w=Object(p.getOr)({},"headers"),E=function(e,t){void 0===t&&(t={});var n=v().fetchClient,r=function(e,t){void 0===t&&(t={});var n=v(),r=n.cacheKey,o=n.data,i=n.setData,c=Object(p.getOr)("GET","method",t),s=Object(a.useState)(t.loading||!1),l=s[0],u=s[1],d=Object(a.useState)(null),h=d[0],b=d[1],j=r(""+Object(p.getOr)("","baseUrl")(t)+e,{params:t.params,query:t.query,method:c});return Object(a.useEffect)((function(){l&&(u(!1),t.onCompleted&&t.onCompleted(o[j]))}),[o,j]),Object(a.useEffect)((function(){h&&t.onError&&t.onError(h)}),[h]),{cacheKey:j,request:function(e){u(!0),e().then((function(e){var t;e.status<200||e.status>=299?(b(e),u(!1)):i(((t={})[j]=e.data,t))})).catch((function(e){b(e.message),u(!1)}))},loading:l,error:h,data:Object(p.get)(j,o)}}(e,t),o=r.loading,i=r.request,c=r.error;return[function(r){var o=Object(p.merge)(t,r),a=j({},t,{path:e,headers:w(r)});Object(p.isEmpty)(S(o))||(a.query=S(o)),Object(p.isEmpty)(y(o))||(a.body=y(o)),i((function(){return n.request(a)}))},{loading:o,data:r.data,error:c}]},x=function(e,t){return void 0===t&&(t={}),E(e,j({},t,{method:"GET"}))},C=(Object(p.getOr)({},"query"),n(17)),I=n(8),_=n.n(I),q=(n(46),"github_access_token"),T=function(){var e,t,n=Object(a.useState)({clientId:window.sessionStorage.getItem("clientId")||"",clientSecret:window.sessionStorage.getItem("clientSecret")||""}),i=Object(l.a)(n,2),c=i[0],s=i[1],u=window.sessionStorage.getItem(q),d=function(e){e.preventDefault(),window.sessionStorage.setItem(e.target.name,e.target.value),s(Object(o.a)(Object(o.a)({},c),{},{[e.target.name]:e.target.value}))},h=Object(a.useState)(1),b=Object(l.a)(h,2),p=b[0],f=b[1],m=(e="/github_access_token",void 0===(t={json:!0,baseUrl:Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).ACCESS_TOKEN_EXCHANGE_SERVER,onCompleted(e){e.access_token&&window.sessionStorage.setItem(q,e.access_token),window.location.href=window.location.pathname.replace("callback","")},onError(e){alert(e.data),window.location.href=window.location.pathname.replace("callback","")}})&&(t={}),E(e,j({},t,{method:"POST"}))),O=Object(l.a)(m,2),g=O[0],v=O[1].loading,y=x("/user/repos",{json:!0,query:{per_page:10},onError(e){alert(e.data),401===e.status&&(window.sessionStorage.clear(),window.location.reload())}}),S=Object(l.a)(y,2),w=S[0],I=S[1],T=I.loading,P=I.data;return Object(a.useEffect)((function(){if(window.location.pathname.includes("/callback")){var e=_.a.parse(window.location.search).code;e&&g({params:{client_id:window.sessionStorage.getItem("clientId"),client_secret:window.sessionStorage.getItem("clientSecret"),code:e,redirect_uri:"http://localhost:3000/callback"}})}}),[]),Object(a.useEffect)((function(){window.sessionStorage.getItem(q)&&w({query:{page:p}})}),[p]),Object(r.jsxs)("div",{className:"App",children:[Object(r.jsx)("h1",{children:"Repositories List"}),v||T?"Loading...":null,u?Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("div",{children:(P||[]).map((function(e){return Object(r.jsxs)("div",{children:["Repo Name: ",e.name]},e.id)}))}),Object(r.jsx)("button",{disabled:T||1===p,onClick:function(){f(p-1)},children:"Previous"}),Object(r.jsx)("button",{disabled:Object(C.isEmpty)(P)||T,onClick:function(){f(p+1)},children:"Next"})]}):Object(r.jsxs)("form",{onSubmit:function(e){e.preventDefault(),window.location.href=_.a.stringifyUrl({url:"https://github.com/login/oauth/authorize",query:{client_id:c.clientId,scope:"user,repo"}})},method:"post",children:[Object(r.jsx)("legend",{children:"Github Credentials"}),Object(r.jsxs)("fieldset",{children:[Object(r.jsx)("label",{htmlFor:"clientId",children:"Client ID"}),Object(r.jsx)("input",{required:!0,id:"clientId",name:"clientId",onChange:d,type:"text",value:c.clientId})]}),Object(r.jsxs)("fieldset",{children:[Object(r.jsx)("label",{htmlFor:"clientSecret",children:"Client Secret"}),Object(r.jsx)("input",{required:!0,id:"clientSecret",name:"clientSecret",type:"password",onChange:d,value:c.clientSecret})]}),Object(r.jsx)("input",{type:"submit",value:"Authroize Github"})]})]})},P=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,48)).then((function(t){var n=t.getCLS,r=t.getFID,o=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),r(e),o(e),a(e),i(e)}))},k=new m("https://api.github.com",{headers:function(){return Object(o.a)(Object(o.a)({},window.sessionStorage.getItem(q)?{Authorization:"token ".concat(window.sessionStorage.getItem(q))}:{}),{},{Accept:"application/vnd.github.v3+json","content-type":"application/json"})}});s.a.render(Object(r.jsx)(i.a.StrictMode,{children:Object(r.jsx)(g,{client:k,children:Object(r.jsx)(T,{})})}),document.getElementById("root")),P()}},[[47,1,2]]]);
//# sourceMappingURL=main.ce22a02a.chunk.js.map